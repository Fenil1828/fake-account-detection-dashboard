<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fake Account Detector - Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
    <link href="/static/css/style.css" rel="stylesheet">
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary sticky-top">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="bi bi-shield-check me-2"></i>
                Fake Account Detector
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="/"><i class="bi bi-house-door me-1"></i> Dashboard</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/analysis"><i class="bi bi-search me-1"></i> Single Analysis</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/batch"><i class="bi bi-file-earmark-spreadsheet me-1"></i> Batch Analysis</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/report"><i class="bi bi-bar-chart-line me-1"></i> Model Report</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-section">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-6">
                    <h1 class="display-4 fw-bold mb-4">Detect Fake Social Media Accounts</h1>
                    <p class="lead mb-4">
                        Advanced machine learning-powered analysis to identify bot accounts, 
                        spam profiles, and suspicious behavior patterns on social media platforms.
                    </p>
                    <div class="d-flex gap-3 flex-wrap">
                        <a href="/analysis" class="btn btn-light btn-lg">
                            <i class="bi bi-search me-2"></i>Analyze Account
                        </a>
                        <a href="/batch" class="btn btn-outline-light btn-lg">
                            <i class="bi bi-upload me-2"></i>Batch Upload
                        </a>
                    </div>
                </div>
                <div class="col-lg-6 text-center mt-5 mt-lg-0">
                    <div class="hero-illustration">
                        <i class="bi bi-shield-fill-check"></i>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Quick Analysis Section -->
    <section class="py-5">
        <div class="container">
            <h2 class="text-center mb-5">Quick Account Analysis</h2>
            
            <div class="row justify-content-center">
                <div class="col-lg-8">
                    <div class="card shadow-lg">
                        <div class="card-body p-4">
                            <form id="quickAnalysisForm" novalidate>
                                <div class="row g-4">
                                    <!-- Basic Information Row -->
                                    <div class="col-lg-6">
                                        <label class="form-label">Username</label>
                                        <input type="text" class="form-control" name="username" placeholder="@username" required>
                                        <small class="text-muted">e.g., @john_doe</small>
                                    </div>
                                    <div class="col-lg-6">
                                        <label class="form-label">Bio</label>
                                        <input type="text" class="form-control" name="bio" placeholder="Account bio/description..." maxlength="500">
                                        <small class="text-muted">Optional account description</small>
                                    </div>
                                    
                                    <!-- Engagement Metrics -->
                                    <div class="col-sm-6 col-md-3">
                                        <label class="form-label">Followers</label>
                                        <input type="number" class="form-control" name="followers_count" placeholder="1000" value="0" required>
                                        <small class="text-muted">Number of followers</small>
                                    </div>
                                    <div class="col-sm-6 col-md-3">
                                        <label class="form-label">Following</label>
                                        <input type="number" class="form-control" name="following_count" placeholder="500" value="0" required>
                                        <small class="text-muted">Accounts being followed</small>
                                    </div>
                                    <div class="col-sm-6 col-md-3">
                                        <label class="form-label">Posts</label>
                                        <input type="number" class="form-control" name="posts_count" placeholder="100" value="0" required>
                                        <small class="text-muted">Total posts count</small>
                                    </div>
                                    <div class="col-sm-6 col-md-3">
                                        <label class="form-label">Account Age (days)</label>
                                        <input type="number" class="form-control" name="account_age_days" placeholder="365" value="365" required>
                                        <small class="text-muted">How old is account</small>
                                    </div>
                                    
                                    <!-- Profile Features -->
                                    <div class="col-sm-6">
                                        <label class="form-label">Has Profile Picture</label>
                                        <select class="form-select" name="has_profile_pic" required>
                                            <option value="true" selected>Yes</option>
                                            <option value="false">No</option>
                                        </select>
                                        <small class="text-muted">Profile image presence</small>
                                    </div>
                                    <div class="col-sm-6">
                                        <label class="form-label">Account Verified</label>
                                        <select class="form-select" name="is_verified">
                                            <option value="false" selected>No</option>
                                            <option value="true">Yes</option>
                                        </select>
                                        <small class="text-muted">Verification status</small>
                                    </div>
                                    
                                    <!-- Engagement Features -->
                                    <div class="col-sm-6 col-md-4">
                                        <label class="form-label">Avg Likes/Post</label>
                                        <input type="number" step="0.1" class="form-control" name="avg_likes_per_post" placeholder="0" value="0">
                                        <small class="text-muted">Average likes per post</small>
                                    </div>
                                    <div class="col-sm-6 col-md-4">
                                        <label class="form-label">Avg Comments/Post</label>
                                        <input type="number" step="0.1" class="form-control" name="avg_comments_per_post" placeholder="0" value="0">
                                        <small class="text-muted">Average comments per post</small>
                                    </div>
                                    <div class="col-sm-6 col-md-4">
                                        <label class="form-label">Posting Regularity</label>
                                        <input type="number" step="0.01" class="form-control" name="posting_regularity" placeholder="0-1" value="0.5" min="0" max="1">
                                        <small class="text-muted">0 (irregular) to 1 (very regular)</small>
                                    </div>
                                    
                                    <!-- Behavior Features -->
                                    <div class="col-sm-6 col-md-4">
                                        <label class="form-label">Session Duration (mins)</label>
                                        <input type="number" step="0.1" class="form-control" name="session_duration_avg" placeholder="30" value="30">
                                        <small class="text-muted">Average session duration</small>
                                    </div>
                                    <div class="col-sm-6 col-md-4">
                                        <label class="form-label">Login Frequency</label>
                                        <input type="number" step="0.1" class="form-control" name="login_frequency" placeholder="1" value="1">
                                        <small class="text-muted">Times per day</small>
                                    </div>
                                    <div class="col-sm-6 col-md-4">
                                        <label class="form-label">Burst Posting Score</label>
                                        <input type="number" step="0.1" class="form-control" name="burst_posting_score" placeholder="0-1" value="0.2" min="0" max="1">
                                        <small class="text-muted">0 (low) to 1 (high burst)</small>
                                    </div>
                                    
                                    <!-- Content Features -->
                                    <div class="col-sm-6">
                                        <label class="form-label">Avg Caption Length</label>
                                        <input type="number" class="form-control" name="avg_caption_length" placeholder="50" value="50">
                                        <small class="text-muted">Average caption characters</small>
                                    </div>
                                    <div class="col-sm-6">
                                        <label class="form-label">Hashtag Density</label>
                                        <input type="number" step="0.01" class="form-control" name="hashtag_density" placeholder="0.1" value="0.1" min="0" max="1">
                                        <small class="text-muted">0 to 1 (hashtag usage)</small>
                                    </div>
                                    <div class="col-sm-6">
                                        <label class="form-label">Spam Words Count</label>
                                        <input type="number" class="form-control" name="spam_word_count" placeholder="0" value="0">
                                        <small class="text-muted">Number of spam words detected</small>
                                    </div>
                                    <div class="col-sm-6">
                                        <label class="form-label">Duplicate Content Ratio</label>
                                        <input type="number" step="0.01" class="form-control" name="duplicate_content_ratio" placeholder="0" value="0" min="0" max="1">
                                        <small class="text-muted">0 (unique) to 1 (all duplicate)</small>
                                    </div>
                                </div>
                                
                                <!-- Action Buttons -->
                                <div class="d-flex gap-3 mt-5">
                                    <button type="submit" class="btn btn-primary btn-lg flex-grow-1">
                                        <i class="bi bi-cpu me-2"></i>Analyze Account
                                    </button>
                                    <button type="button" class="btn btn-outline-secondary btn-lg" onclick="loadSample()">
                                        <i class="bi bi-lightning me-1"></i>Load Sample
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Results Section -->
            <div id="resultsSection" class="mt-5" style="display: none;">
                <div class="row justify-content-center">
                    <div class="col-lg-10">
                        <div class="card shadow">
                            <div class="card-header bg-white">
                                <h4 class="mb-0"><i class="bi bi-clipboard-data me-2"></i>Analysis Results</h4>
                            </div>
                            <div class="card-body">
                                <!-- Risk Score Card -->
                                <div class="row">
                                    <div class="col-md-4">
                                        <div id="riskScoreCard" class="text-center p-4 rounded-3 mb-3">
                                            <h2 class="display-3 fw-bold" id="riskScoreValue">0%</h2>
                                            <p class="mb-0" id="riskLevelText">Risk Level</p>
                                        </div>
                                        <div class="text-center">
                                            <span class="badge fs-6" id="classificationBadge">Classification</span>
                                        </div>
                                        <div class="mt-3 text-center">
                                            <small class="text-muted">Confidence: <span id="confidenceValue">0%</span></small>
                                        </div>
                                    </div>
                                    <div class="col-md-8">
                                        <h5>Summary</h5>
                                        <p id="summaryText" class="text-muted"></p>
                                        
                                        <div class="row mt-4">
                                            <div class="col-md-6">
                                                <h6 class="text-danger"><i class="bi bi-exclamation-triangle me-1"></i>Suspicious Factors</h6>
                                                <ul id="suspiciousFactors" class="list-unstyled small"></ul>
                                            </div>
                                            <div class="col-md-6">
                                                <h6 class="text-success"><i class="bi bi-check-circle me-1"></i>Positive Factors</h6>
                                                <ul id="positiveFactors" class="list-unstyled small"></ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <hr class="my-4">
                                
                                <!-- Charts -->
                                <div class="row">
                                    <div class="col-md-6">
                                        <div id="engagementChart"></div>
                                    </div>
                                    <div class="col-md-6">
                                        <div id="followersChart"></div>
                                    </div>
                                </div>
                                
                                <div class="mt-4">
                                    <a href="/analysis" class="btn btn-outline-primary">
                                        <i class="bi bi-arrows-fullscreen me-1"></i>Full Analysis
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="py-5 bg-light">
        <div class="container">
            <h2 class="text-center mb-5">Detection Features</h2>
            
            <div class="row g-4">
                <div class="col-md-4">
                    <div class="card h-100 border-0 shadow-sm feature-card">
                        <div class="card-body text-center p-4">
                            <div class="feature-icon bg-primary-subtle text-primary rounded-circle mx-auto mb-3">
                                <i class="bi bi-graph-up"></i>
                            </div>
                            <h5>Behavior Analysis</h5>
                            <p class="text-muted">Analyze login patterns, session durations, and posting frequency to detect automated behavior.</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card h-100 border-0 shadow-sm feature-card">
                        <div class="card-body text-center p-4">
                            <div class="feature-icon bg-success-subtle text-success rounded-circle mx-auto mb-3">
                                <i class="bi bi-people"></i>
                            </div>
                            <h5>Network Analysis</h5>
                            <p class="text-muted">Examine follower/following ratios, connection patterns, and social graph anomalies.</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card h-100 border-0 shadow-sm feature-card">
                        <div class="card-body text-center p-4">
                            <div class="feature-icon bg-warning-subtle text-warning rounded-circle mx-auto mb-3">
                                <i class="bi bi-chat-text"></i>
                            </div>
                            <h5>Content Analysis</h5>
                            <p class="text-muted">Detect spam patterns, duplicate content, and suspicious linguistic markers.</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card h-100 border-0 shadow-sm feature-card">
                        <div class="card-body text-center p-4">
                            <div class="feature-icon bg-info-subtle text-info rounded-circle mx-auto mb-3">
                                <i class="bi bi-person-badge"></i>
                            </div>
                            <h5>Profile Completeness</h5>
                            <p class="text-muted">Evaluate profile pictures, bios, and metadata for signs of incomplete profiles.</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card h-100 border-0 shadow-sm feature-card">
                        <div class="card-body text-center p-4">
                            <div class="feature-icon bg-danger-subtle text-danger rounded-circle mx-auto mb-3">
                                <i class="bi bi-cpu"></i>
                            </div>
                            <h5>ML Classification</h5>
                            <p class="text-muted">Ensemble machine learning models for accurate fake account prediction.</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card h-100 border-0 shadow-sm feature-card">
                        <div class="card-body text-center p-4">
                            <div class="feature-icon bg-secondary-subtle text-secondary rounded-circle mx-auto mb-3">
                                <i class="bi bi-lightbulb"></i>
                            </div>
                            <h5>Explainability</h5>
                            <p class="text-muted">Clear explanations for why accounts are flagged as suspicious or genuine.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Sample Accounts Section -->
    <section class="py-5">
        <div class="container">
            <h2 class="text-center mb-5">Try Sample Accounts</h2>
            
            <div id="sampleAccountsContainer" class="row g-4">
                <!-- Sample accounts will be loaded here -->
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-dark text-white py-4">
        <div class="container text-center">
            <p class="mb-0">
                <i class="bi bi-shield-check me-2"></i>
                Team RapidX &copy; 2025
            </p>
            <small class="text-muted">Built with Machine Learning for Social Media Safety</small>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/static/js/main.js"></script>
    <script>
        // Load sample accounts on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadSampleAccounts();
        });
        
        // Quick analysis form handler
        document.getElementById('quickAnalysisForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const submitBtn = this.querySelector('button[type="submit"]');
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm me-2"></span>Analyzing...';
            
            try {
                const response = await fetch('/api/analyze', {
                    method: 'POST',
                    body: formData
                });
                
                const data = await response.json();
                
                if (data.success) {
                    displayResults(data.result);
                } else {
                    alert('Error: ' + data.error);
                }
            } catch (error) {
                alert('Error analyzing account: ' + error.message);
            } finally {
                submitBtn.disabled = false;
                submitBtn.innerHTML = '<i class="bi bi-cpu me-2"></i>Analyze Account';
            }
        });
        
        function displayResults(result) {
            document.getElementById('resultsSection').style.display = 'block';
            
            // Update risk score
            const riskPercent = Math.round(result.risk_score * 100);
            document.getElementById('riskScoreValue').textContent = riskPercent + '%';
            document.getElementById('riskLevelText').textContent = result.risk_level + ' Risk';
            document.getElementById('confidenceValue').textContent = Math.round(result.confidence * 100) + '%';
            
            // Update risk card color
            const riskCard = document.getElementById('riskScoreCard');
            riskCard.className = 'text-center p-4 rounded-3 mb-3 ';
            if (result.risk_score < 0.4) {
                riskCard.classList.add('bg-success-subtle', 'text-success');
            } else if (result.risk_score < 0.7) {
                riskCard.classList.add('bg-warning-subtle', 'text-warning');
            } else {
                riskCard.classList.add('bg-danger-subtle', 'text-danger');
            }
            
            // Update classification badge
            const badge = document.getElementById('classificationBadge');
            badge.textContent = result.classification;
            badge.className = 'badge fs-6 ' + (result.is_fake ? 'bg-danger' : 'bg-success');
            
            // Update summary
            document.getElementById('summaryText').textContent = result.explanation.summary;
            
            // Update factors
            const suspiciousList = document.getElementById('suspiciousFactors');
            suspiciousList.innerHTML = '';
            result.suspicious_attributes.forEach(factor => {
                const li = document.createElement('li');
                li.className = 'mb-2';
                li.innerHTML = `<strong>${factor.factor}</strong><br><span class="text-muted">${factor.detail}</span>`;
                suspiciousList.appendChild(li);
            });
            
            const positiveList = document.getElementById('positiveFactors');
            positiveList.innerHTML = '';
            result.positive_attributes.forEach(factor => {
                const li = document.createElement('li');
                li.className = 'mb-2';
                li.innerHTML = `<strong>${factor.factor}</strong><br><span class="text-muted">${factor.detail}</span>`;
                positiveList.appendChild(li);
            });
            
            // Render charts
            if (result.charts) {
                if (result.charts.engagement) {
                    Plotly.newPlot('engagementChart', JSON.parse(result.charts.engagement).data, JSON.parse(result.charts.engagement).layout, {responsive: true});
                }
                if (result.charts.followers) {
                    Plotly.newPlot('followersChart', JSON.parse(result.charts.followers).data, JSON.parse(result.charts.followers).layout, {responsive: true});
                }
            }
            
            // Scroll to results
            document.getElementById('resultsSection').scrollIntoView({ behavior: 'smooth' });
        }
        
        async function loadSampleAccounts() {
            try {
                const response = await fetch('/api/sample-accounts');
                const data = await response.json();
                
                if (data.success) {
                    const container = document.getElementById('sampleAccountsContainer');
                    container.innerHTML = '';
                    
                    data.samples.forEach((sample, index) => {
                        const col = document.createElement('div');
                        col.className = 'col-md-6 col-lg-3';
                        col.innerHTML = `
                            <div class="card h-100 sample-card" onclick="loadSampleToForm(${index})">
                                <div class="card-body">
                                    <h6 class="card-title">@${sample.username}</h6>
                                    <p class="card-text small text-muted">
                                        <i class="bi bi-people me-1"></i>${sample.followers_count.toLocaleString()} followers<br>
                                        <i class="bi bi-image me-1"></i>${sample.posts_count} posts
                                    </p>
                                    <span class="badge ${sample.has_profile_pic ? 'bg-success' : 'bg-secondary'}">
                                        ${sample.has_profile_pic ? 'Has Profile Pic' : 'No Profile Pic'}
                                    </span>
                                </div>
                            </div>
                        `;
                        container.appendChild(col);
                    });
                    
                    window.sampleAccounts = data.samples;
                }
            } catch (error) {
                console.error('Error loading samples:', error);
            }
        }
        
        function loadSampleToForm(index) {
            const sample = window.sampleAccounts[index];
            if (sample) {
                document.querySelector('input[name="username"]').value = sample.username;
                document.querySelector('input[name="followers_count"]').value = sample.followers_count;
                document.querySelector('input[name="following_count"]').value = sample.following_count;
                document.querySelector('input[name="posts_count"]').value = sample.posts_count;
                document.querySelector('input[name="account_age_days"]').value = sample.account_age_days;
                document.querySelector('select[name="has_profile_pic"]').value = sample.has_profile_pic ? 'true' : 'false';
                document.querySelector('textarea[name="bio"]').value = sample.bio || '';
                
                document.getElementById('quickAnalysisForm').scrollIntoView({ behavior: 'smooth' });
            }
        }
        
        function loadSample() {
            if (window.sampleAccounts && window.sampleAccounts.length > 0) {
                const randomIndex = Math.floor(Math.random() * window.sampleAccounts.length);
                loadSampleToForm(randomIndex);
            }
        }
    </script>
</body>
</html>
